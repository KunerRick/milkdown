{"version":3,"file":"index.es.js","sources":["../src/code.ts","../src/error.ts","../src/index.ts"],"sourcesContent":["/* Copyright 2021, Milkdown by Mirone. */\nexport const enum ErrorCode {\n    docTypeError = 'docTypeError',\n    contextNotFound = 'contextNotFound',\n    timerNotFound = 'timerNotFound',\n    ctxCallOutOfScope = 'ctxCallOutOfScope',\n    createNodeInParserFail = 'createNodeInParserFail',\n    stackOverFlow = 'stackOverFlow',\n    parserMatchError = 'parserMatchError',\n    serializerMatchError = 'serializerMatchError',\n    getAtomFromSchemaFail = 'getAtomFromSchemaFail',\n    expectDomTypeError = 'expectDomTypeError',\n    callCommandBeforeEditorView = 'callCommandBeforeEditorView',\n    themeMustInstalled = 'themeMustInstalled',\n    missingRootElement = 'missingRootElement',\n    missingNodeInSchema = 'missingNodeInSchema',\n    missingMarkInSchema = 'missingMarkInSchema',\n\n    // theme\n    missingIcon = 'missingIcon',\n\n    // vue\n    vueRendererCallOutOfScope = 'vueRendererCallOutOfScope',\n\n    // collab plugin\n    ctxNotBind = 'ctxNotBind',\n    missingYjsDoc = 'missingYjsDoc',\n\n    // menu plugin\n    repeatCallsToMenuWrapperInit = 'repeatCallsToMenuWrapperInit',\n    missingMenuWrapper = 'missingMenuWrapper',\n}\n","/* Copyright 2021, Milkdown by Mirone. */\n\nimport { ErrorCode } from './code';\n\nexport class MilkdownError extends Error {\n    public code: string;\n    constructor(code: ErrorCode, message: string) {\n        super(message);\n        this.name = 'MilkdownError';\n        this.code = code;\n    }\n}\n","/* Copyright 2021, Milkdown by Mirone. */\nimport { ErrorCode } from './code';\nimport { MilkdownError } from './error';\n\nconst functionReplacer = (_: string, value: unknown) => (typeof value === 'function' ? '[Function]' : value);\n\nconst stringify = (x: unknown): string => JSON.stringify(x, functionReplacer);\n\nexport const docTypeError = (type: unknown) =>\n    new MilkdownError(ErrorCode.docTypeError, `Doc type error, unsupported type: ${stringify(type)}`);\n\nexport const contextNotFound = (name: string) =>\n    new MilkdownError(ErrorCode.contextNotFound, `Context \"${name}\" not found, do you forget to inject it?`);\n\nexport const timerNotFound = (name: string) =>\n    new MilkdownError(ErrorCode.timerNotFound, `Timer \"${name}\" not found, do you forget to record it?`);\n\nexport const ctxCallOutOfScope = () =>\n    new MilkdownError(ErrorCode.ctxCallOutOfScope, 'Should not call a context out of the plugin.');\n\nexport const createNodeInParserFail = (...args: unknown[]) => {\n    const message = args.reduce((msg, arg) => {\n        if (!arg) {\n            return msg;\n        }\n        const serialize = (x: unknown): string => {\n            if (Array.isArray(x)) {\n                return (x as unknown[]).map((y) => serialize(y)).join(', ');\n            }\n            if ((x as { toJSON(): Record<string, unknown> }).toJSON) {\n                return stringify((x as { toJSON(): Record<string, unknown> }).toJSON());\n            }\n\n            if ((x as { spec: string }).spec) {\n                return stringify((x as { spec: string }).spec);\n            }\n\n            return (x as { toString(): string }).toString();\n        };\n        return `${msg}, ${serialize(arg)}`;\n    }, 'Create prosemirror node from remark failed in parser') as string;\n\n    return new MilkdownError(ErrorCode.createNodeInParserFail, message);\n};\n\nexport const stackOverFlow = () =>\n    new MilkdownError(ErrorCode.stackOverFlow, 'Stack over flow, cannot pop on an empty stack.');\n\nexport const parserMatchError = (node: unknown) =>\n    new MilkdownError(ErrorCode.parserMatchError, `Cannot match target parser for node: ${stringify(node)}.`);\n\nexport const serializerMatchError = (node: unknown) =>\n    new MilkdownError(ErrorCode.serializerMatchError, `Cannot match target serializer for node: ${stringify(node)}.`);\n\nexport const getAtomFromSchemaFail = (type: 'mark' | 'node', name: string) =>\n    new MilkdownError(ErrorCode.getAtomFromSchemaFail, `Cannot get ${type}: ${name} from schema.`);\n\nexport const expectDomTypeError = (node: unknown) =>\n    new MilkdownError(ErrorCode.expectDomTypeError, `Expect to be a dom, but get: ${stringify(node)}.`);\n\nexport const callCommandBeforeEditorView = () =>\n    new MilkdownError(\n        ErrorCode.callCommandBeforeEditorView,\n        `You're trying to call a command before editor view initialized, make sure to get commandManager from ctx after editor view has been initialized`,\n    );\n\nexport const themeMustInstalled = () =>\n    new MilkdownError(\n        ErrorCode.themeMustInstalled,\n        `It seems that no theme found in editor, please make sure you have use theme in front of all plugins.\nIf you prefer to use an empty theme, you can use \\`themeFactory({})\\`.`,\n    );\n\nexport const missingRootElement = () =>\n    new MilkdownError(\n        ErrorCode.missingRootElement,\n        'Missing root element, milkdown cannot find root element of the editor.',\n    );\n\nexport const missingNodeInSchema = (name: string) =>\n    new MilkdownError(\n        ErrorCode.missingNodeInSchema,\n        `Missing node in schema, milkdown cannot find \"${name}\" in schema.`,\n    );\n\nexport const missingMarkInSchema = (name: string) =>\n    new MilkdownError(\n        ErrorCode.missingMarkInSchema,\n        `Missing mark in schema, milkdown cannot find \"${name}\" in schema.`,\n    );\n\nexport const missingIcon = (name: string) =>\n    new MilkdownError(ErrorCode.missingIcon, `Missing icon in theme, milkdown cannot find icon \"${name}\" in theme.`);\n\nexport const ctxNotBind = () =>\n    new MilkdownError(ErrorCode.ctxNotBind, 'Context not bind, please make sure the plugin has been initialized.');\n\nexport const missingYjsDoc = () =>\n    new MilkdownError(ErrorCode.missingYjsDoc, 'Missing yjs doc, please make sure you have bind one.');\n\nexport const vueRendererCallOutOfScope = () =>\n    new MilkdownError(ErrorCode.vueRendererCallOutOfScope, 'Should not call vue renderer before it has been created.');\n\nexport const missingMenuWrapper = () =>\n    new MilkdownError(ErrorCode.missingMenuWrapper, 'Missing menu wrapper, should init menu wrapper first.');\n\nexport const repeatCallsToMenuWrapperInit = () =>\n    new MilkdownError(ErrorCode.repeatCallsToMenuWrapperInit, 'Repeated calls to menu wrapper initialization');\n"],"names":[],"mappings":"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"}