import{aj as Fe,ak as Ne,al as hn,am as q,an as Ie,ao as Pt,ap as Ht,aq as _,ar as st,as as pn,at as tt,au as Dt,av as dn,aw as Zt,ax as X,ay as fn,az as mn,aA as gn,aB as bt,aC as Yt,aD as Qt,aE as wn,aF as bn,aG as Oe,aH as kn,aI as Cn,u as Y,t as z,o as T,aJ as yn,y as Bt,J as kt,a1 as Ct,w as R,V as et,z as it,d as _e,aK as xn,W as j,m as P,n as U,P as $t,aL as vn,Q as Wt,l as I,a3 as O,U as Pe,G as jt,a5 as An,a6 as Sn,aM as te,x as Mn,B as Dn,aN as $n,H as Ln,a8 as ee,aO as Tn,X as Rn,g as En,h as zn}from"./index.6bf54807.js";import{L as Ut,N as Fn,z as Nn,k as In,r as On,t as _n,w as He,I as Be,c as V,s as Pn,a as Hn,l as Bn,M as Wn,o as jn}from"./index.es.ebedf351.js";const Un={tokenize:Xn,partial:!0},We={tokenize:Jn,partial:!0},je={tokenize:Zn,partial:!0},nt={tokenize:Qn,partial:!0},Ue={tokenize:Yn,partial:!0},Ve={tokenize:Kn,previous:Ge},qe={tokenize:Gn,previous:qt},H={tokenize:qn,previous:Xe},N={},Vn={text:N};let J=48;for(;J<123;)N[J]=H,J++,J===58?J=65:J===91&&(J=97);N[43]=H;N[45]=H;N[46]=H;N[95]=H;N[72]=[H,qe];N[104]=[H,qe];N[87]=[H,Ve];N[119]=[H,Ve];function qn(t,e,n){const r=this;let i,l;return o;function o(f){return!ne(f)||!Xe(r.previous)||Kt(r.events)?n(f):(t.enter("literalAutolink"),t.enter("literalAutolinkEmail"),s(f))}function s(f){return ne(f)?(t.consume(f),s):f===64?(t.consume(f),a):n(f)}function a(f){return f===46?t.check(nt,d,c)(f):f===45||f===95?t.check(nt,n,u)(f):Fe(f)?(!l&&hn(f)&&(l=!0),t.consume(f),a):d(f)}function c(f){return t.consume(f),i=!0,l=void 0,a}function u(f){return t.consume(f),h}function h(f){return f===46?t.check(nt,n,c)(f):a(f)}function d(f){return i&&!l?(t.exit("literalAutolinkEmail"),t.exit("literalAutolink"),e(f)):n(f)}}function Kn(t,e,n){const r=this;return i;function i(o){return o!==87&&o!==119||!Ge(r.previous)||Kt(r.events)?n(o):(t.enter("literalAutolink"),t.enter("literalAutolinkWww"),t.check(Un,t.attempt(We,t.attempt(je,l),n),n)(o))}function l(o){return t.exit("literalAutolinkWww"),t.exit("literalAutolink"),e(o)}}function Gn(t,e,n){const r=this;return i;function i(p){return p!==72&&p!==104||!qt(r.previous)||Kt(r.events)?n(p):(t.enter("literalAutolink"),t.enter("literalAutolinkHttp"),t.consume(p),l)}function l(p){return p===84||p===116?(t.consume(p),o):n(p)}function o(p){return p===84||p===116?(t.consume(p),s):n(p)}function s(p){return p===80||p===112?(t.consume(p),a):n(p)}function a(p){return p===83||p===115?(t.consume(p),c):c(p)}function c(p){return p===58?(t.consume(p),u):n(p)}function u(p){return p===47?(t.consume(p),h):n(p)}function h(p){return p===47?(t.consume(p),d):n(p)}function d(p){return p===null||Ie(p)||Pt(p)||Ht(p)?n(p):t.attempt(We,t.attempt(je,f),n)(p)}function f(p){return t.exit("literalAutolinkHttp"),t.exit("literalAutolink"),e(p)}}function Xn(t,e,n){return r;function r(a){return t.consume(a),i}function i(a){return a===87||a===119?(t.consume(a),l):n(a)}function l(a){return a===87||a===119?(t.consume(a),o):n(a)}function o(a){return a===46?(t.consume(a),s):n(a)}function s(a){return a===null||_(a)?n(a):e(a)}}function Jn(t,e,n){let r,i;return l;function l(a){return a===38?t.check(Ue,s,o)(a):a===46||a===95?t.check(nt,s,o)(a):a===null||Ie(a)||Pt(a)||a!==45&&Ht(a)?s(a):(t.consume(a),l)}function o(a){return a===46?(i=r,r=void 0,t.consume(a),l):(a===95&&(r=!0),t.consume(a),l)}function s(a){return!i&&!r?e(a):n(a)}}function Zn(t,e){let n=0;return r;function r(o){return o===38?t.check(Ue,e,i)(o):(o===40&&n++,o===41?t.check(nt,l,i)(o):Vt(o)?e(o):Ke(o)?t.check(nt,e,i)(o):(t.consume(o),r))}function i(o){return t.consume(o),r}function l(o){return n--,n<0?e(o):i(o)}}function Yn(t,e,n){return r;function r(o){return t.consume(o),i}function i(o){return Ne(o)?(t.consume(o),i):o===59?(t.consume(o),l):n(o)}function l(o){return Vt(o)?e(o):n(o)}}function Qn(t,e,n){return r;function r(l){return t.consume(l),i}function i(l){return Ke(l)?(t.consume(l),i):Vt(l)?e(l):n(l)}}function Ke(t){return t===33||t===34||t===39||t===41||t===42||t===44||t===46||t===58||t===59||t===60||t===63||t===95||t===126}function Vt(t){return t===null||t===60||q(t)}function ne(t){return t===43||t===45||t===46||t===95||Fe(t)}function Ge(t){return t===null||t===40||t===42||t===95||t===126||q(t)}function qt(t){return t===null||!Ne(t)}function Xe(t){return t!==47&&qt(t)}function Kt(t){let e=t.length,n=!1;for(;e--;){const r=t[e][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return t.length>0&&!n&&(t[t.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const tr={tokenize:sr,partial:!0};function er(){return{document:{[91]:{tokenize:lr,continuation:{tokenize:or},exit:ar}},text:{[91]:{tokenize:ir},[93]:{add:"after",tokenize:nr,resolveTo:rr}}}}function nr(t,e,n){const r=this;let i=r.events.length;const l=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;i--;){const a=r.events[i][1];if(a.type==="labelImage"){o=a;break}if(a.type==="gfmFootnoteCall"||a.type==="labelLink"||a.type==="label"||a.type==="image"||a.type==="link")break}return s;function s(a){if(!o||!o._balanced)return n(a);const c=st(r.sliceSerialize({start:o.end,end:r.now()}));return c.charCodeAt(0)!==94||!l.includes(c.slice(1))?n(a):(t.enter("gfmFootnoteCallLabelMarker"),t.consume(a),t.exit("gfmFootnoteCallLabelMarker"),e(a))}}function rr(t,e){let n=t.length;for(;n--;)if(t[n][1].type==="labelImage"&&t[n][0]==="enter"){t[n][1];break}t[n+1][1].type="data",t[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},t[n+3][1].start),end:Object.assign({},t[t.length-1][1].end)},i={type:"gfmFootnoteCallMarker",start:Object.assign({},t[n+3][1].end),end:Object.assign({},t[n+3][1].end)};i.end.column++,i.end.offset++,i.end._bufferIndex++;const l={type:"gfmFootnoteCallString",start:Object.assign({},i.end),end:Object.assign({},t[t.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},l.start),end:Object.assign({},l.end)},s=[t[n+1],t[n+2],["enter",r,e],t[n+3],t[n+4],["enter",i,e],["exit",i,e],["enter",l,e],["enter",o,e],["exit",o,e],["exit",l,e],t[t.length-2],t[t.length-1],["exit",r,e]];return t.splice(n,t.length-n+1,...s),t}function ir(t,e,n){const r=this,i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l=0,o;return s;function s(d){return t.enter("gfmFootnoteCall"),t.enter("gfmFootnoteCallLabelMarker"),t.consume(d),t.exit("gfmFootnoteCallLabelMarker"),a}function a(d){return d!==94?n(d):(t.enter("gfmFootnoteCallMarker"),t.consume(d),t.exit("gfmFootnoteCallMarker"),t.enter("gfmFootnoteCallString"),t.enter("chunkString").contentType="string",c)}function c(d){let f;return d===null||d===91||l++>999?n(d):d===93?o?(t.exit("chunkString"),f=t.exit("gfmFootnoteCallString"),i.includes(st(r.sliceSerialize(f)))?h(d):n(d)):n(d):(t.consume(d),q(d)||(o=!0),d===92?u:c)}function u(d){return d===91||d===92||d===93?(t.consume(d),l++,c):c(d)}function h(d){return t.enter("gfmFootnoteCallLabelMarker"),t.consume(d),t.exit("gfmFootnoteCallLabelMarker"),t.exit("gfmFootnoteCall"),e}}function lr(t,e,n){const r=this,i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let l,o=0,s;return a;function a(g){return t.enter("gfmFootnoteDefinition")._container=!0,t.enter("gfmFootnoteDefinitionLabel"),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(g),t.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(g){return g===94?(t.enter("gfmFootnoteDefinitionMarker"),t.consume(g),t.exit("gfmFootnoteDefinitionMarker"),t.enter("gfmFootnoteDefinitionLabelString"),u):n(g)}function u(g){let w;return g===null||g===91||o>999?n(g):g===93?s?(w=t.exit("gfmFootnoteDefinitionLabelString"),l=st(r.sliceSerialize(w)),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(g),t.exit("gfmFootnoteDefinitionLabelMarker"),t.exit("gfmFootnoteDefinitionLabel"),f):n(g):_(g)?(t.enter("lineEnding"),t.consume(g),t.exit("lineEnding"),o++,u):(t.enter("chunkString").contentType="string",h(g))}function h(g){return g===null||_(g)||g===91||g===93||o>999?(t.exit("chunkString"),u(g)):(q(g)||(s=!0),o++,t.consume(g),g===92?d:h)}function d(g){return g===91||g===92||g===93?(t.consume(g),o++,h):h(g)}function f(g){return g===58?(t.enter("definitionMarker"),t.consume(g),t.exit("definitionMarker"),tt(t,p,"gfmFootnoteDefinitionWhitespace")):n(g)}function p(g){return i.includes(l)||i.push(l),e(g)}}function or(t,e,n){return t.check(pn,e,t.attempt(tr,e,n))}function ar(t){t.exit("gfmFootnoteDefinition")}function sr(t,e,n){const r=this;return tt(t,i,"gfmFootnoteDefinitionIndent",4+1);function i(l){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?e(l):n(l)}}function cr(t={}){let e=t.singleTilde;const n={tokenize:i,resolveAll:r};return e==null&&(e=!0),{text:{[126]:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function r(l,o){let s=-1;for(;++s<l.length;)if(l[s][0]==="enter"&&l[s][1].type==="strikethroughSequenceTemporary"&&l[s][1]._close){let a=s;for(;a--;)if(l[a][0]==="exit"&&l[a][1].type==="strikethroughSequenceTemporary"&&l[a][1]._open&&l[s][1].end.offset-l[s][1].start.offset===l[a][1].end.offset-l[a][1].start.offset){l[s][1].type="strikethroughSequence",l[a][1].type="strikethroughSequence";const c={type:"strikethrough",start:Object.assign({},l[a][1].start),end:Object.assign({},l[s][1].end)},u={type:"strikethroughText",start:Object.assign({},l[a][1].end),end:Object.assign({},l[s][1].start)},h=[["enter",c,o],["enter",l[a][1],o],["exit",l[a][1],o],["enter",u,o]];Dt(h,h.length,0,dn(o.parser.constructs.insideSpan.null,l.slice(a+1,s),o)),Dt(h,h.length,0,[["exit",u,o],["enter",l[s][1],o],["exit",l[s][1],o],["exit",c,o]]),Dt(l,a-1,s-a+3,h),s=a+h.length-2;break}}for(s=-1;++s<l.length;)l[s][1].type==="strikethroughSequenceTemporary"&&(l[s][1].type="data");return l}function i(l,o,s){const a=this.previous,c=this.events;let u=0;return h;function h(f){return a===126&&c[c.length-1][1].type!=="characterEscape"?s(f):(l.enter("strikethroughSequenceTemporary"),d(f))}function d(f){const p=Zt(a);if(f===126)return u>1?s(f):(l.consume(f),u++,d);if(u<2&&!e)return s(f);const g=l.exit("strikethroughSequenceTemporary"),w=Zt(f);return g._open=!w||w===2&&Boolean(p),g._close=!p||p===2&&Boolean(w),o(f)}}}const ur={flow:{null:{tokenize:pr,resolve:hr}}},re={tokenize:dr,partial:!0};function hr(t,e){let n=-1,r,i,l,o,s,a,c;for(;++n<t.length;){const u=t[n][1];if(l&&(u.type==="temporaryTableCellContent"&&(o=o||n,s=n),(u.type==="tableCellDivider"||u.type==="tableRow")&&s)){const h={type:"tableContent",start:t[o][1].start,end:t[s][1].end},d={type:"chunkText",start:h.start,end:h.end,contentType:"text"};t.splice(o,s-o+1,["enter",h,e],["enter",d,e],["exit",d,e],["exit",h,e]),n-=s-o-3,o=void 0,s=void 0}if(t[n][0]==="exit"&&a!==void 0&&a+(c?0:1)<n&&(u.type==="tableCellDivider"||u.type==="tableRow"&&(a+3<n||t[a][1].type!=="whitespace"))){const h={type:i?"tableDelimiter":r?"tableHeader":"tableData",start:t[a][1].start,end:t[n][1].end};t.splice(n+(u.type==="tableCellDivider"?1:0),0,["exit",h,e]),t.splice(a,0,["enter",h,e]),n+=2,a=n+1,c=!0}u.type==="tableRow"&&(l=t[n][0]==="enter",l&&(a=n+1,c=!1)),u.type==="tableDelimiterRow"&&(i=t[n][0]==="enter",i&&(a=n+1,c=!1)),u.type==="tableHead"&&(r=t[n][0]==="enter")}return t}function pr(t,e,n){const r=this,i=[];let l=0,o,s;return a;function a(m){return t.enter("table")._align=i,t.enter("tableHead"),t.enter("tableRow"),m===124?c(m):(l++,t.enter("temporaryTableCellContent"),d(m))}function c(m){return t.enter("tableCellDivider"),t.consume(m),t.exit("tableCellDivider"),o=!0,u}function u(m){return m===null||_(m)?p(m):X(m)?(t.enter("whitespace"),t.consume(m),h):(o&&(o=void 0,l++),m===124?c(m):(t.enter("temporaryTableCellContent"),d(m)))}function h(m){return X(m)?(t.consume(m),h):(t.exit("whitespace"),u(m))}function d(m){return m===null||m===124||q(m)?(t.exit("temporaryTableCellContent"),u(m)):(t.consume(m),m===92?f:d)}function f(m){return m===92||m===124?(t.consume(m),d):d(m)}function p(m){if(m===null)return n(m);t.exit("tableRow"),t.exit("tableHead");const ut=r.interrupt;return r.interrupt=!0,t.attempt({tokenize:St,partial:!0},function(K){return r.interrupt=ut,t.enter("tableDelimiterRow"),g(K)},function(K){return r.interrupt=ut,n(K)})(m)}function g(m){return m===null||_(m)?A(m):X(m)?(t.enter("whitespace"),t.consume(m),w):m===45?(t.enter("tableDelimiterFiller"),t.consume(m),s=!0,i.push("none"),b):m===58?(t.enter("tableDelimiterAlignment"),t.consume(m),t.exit("tableDelimiterAlignment"),i.push("left"),C):m===124?(t.enter("tableCellDivider"),t.consume(m),t.exit("tableCellDivider"),g):n(m)}function w(m){return X(m)?(t.consume(m),w):(t.exit("whitespace"),g(m))}function b(m){return m===45?(t.consume(m),b):(t.exit("tableDelimiterFiller"),m===58?(t.enter("tableDelimiterAlignment"),t.consume(m),t.exit("tableDelimiterAlignment"),i[i.length-1]=i[i.length-1]==="left"?"center":"right",x):g(m))}function C(m){return m===45?(t.enter("tableDelimiterFiller"),t.consume(m),s=!0,b):n(m)}function x(m){return m===null||_(m)?A(m):X(m)?(t.enter("whitespace"),t.consume(m),w):m===124?(t.enter("tableCellDivider"),t.consume(m),t.exit("tableCellDivider"),g):n(m)}function A(m){return t.exit("tableDelimiterRow"),!s||l!==i.length?n(m):m===null?v(m):t.check(re,v,t.attempt({tokenize:St,partial:!0},tt(t,B,"linePrefix",4),v))(m)}function v(m){return t.exit("table"),e(m)}function B(m){return t.enter("tableBody"),S(m)}function S(m){return t.enter("tableRow"),m===124?Q(m):(t.enter("temporaryTableCellContent"),lt(m))}function Q(m){return t.enter("tableCellDivider"),t.consume(m),t.exit("tableCellDivider"),vt}function vt(m){return m===null||_(m)?sn(m):X(m)?(t.enter("whitespace"),t.consume(m),Jt):m===124?Q(m):(t.enter("temporaryTableCellContent"),lt(m))}function Jt(m){return X(m)?(t.consume(m),Jt):(t.exit("whitespace"),vt(m))}function lt(m){return m===null||m===124||q(m)?(t.exit("temporaryTableCellContent"),vt(m)):(t.consume(m),m===92?an:lt)}function an(m){return m===92||m===124?(t.consume(m),lt):lt(m)}function sn(m){return t.exit("tableRow"),m===null?At(m):t.check(re,At,t.attempt({tokenize:St,partial:!0},tt(t,S,"linePrefix",4),At))(m)}function At(m){return t.exit("tableBody"),v(m)}function St(m,ut,K){return cn;function cn(G){return m.enter("lineEnding"),m.consume(G),m.exit("lineEnding"),tt(m,un,"linePrefix")}function un(G){if(r.parser.lazy[r.now().line]||G===null||_(G))return K(G);const ht=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&ht&&ht[1].type==="linePrefix"&&ht[2].sliceSerialize(ht[1],!0).length>=4?K(G):(r._gfmTableDynamicInterruptHack=!0,m.check(r.parser.constructs.flow,function(Mt){return r._gfmTableDynamicInterruptHack=!1,K(Mt)},function(Mt){return r._gfmTableDynamicInterruptHack=!1,ut(Mt)})(G))}}}function dr(t,e,n){let r=0;return i;function i(o){return t.enter("check"),t.consume(o),l}function l(o){return o===-1||o===32?(t.consume(o),r++,r===4?e:l):o===null||q(o)?e(o):n(o)}}const fr={tokenize:gr},mr={text:{[91]:fr}};function gr(t,e,n){const r=this;return i;function i(s){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(s):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(s),t.exit("taskListCheckMarker"),l)}function l(s){return q(s)?(t.enter("taskListCheckValueUnchecked"),t.consume(s),t.exit("taskListCheckValueUnchecked"),o):s===88||s===120?(t.enter("taskListCheckValueChecked"),t.consume(s),t.exit("taskListCheckValueChecked"),o):n(s)}function o(s){return s===93?(t.enter("taskListCheckMarker"),t.consume(s),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),t.check({tokenize:wr},e,n)):n(s)}}function wr(t,e,n){const r=this;return tt(t,i,"whitespace");function i(l){const o=r.events[r.events.length-1];return(o&&o[1].type==="whitespace"||_(l))&&l!==null?e(l):n(l)}}function br(t){return fn([Vn,er(),cr(t),ur,mr])}function ie(t,e){const n=String(t);if(typeof e!="string")throw new TypeError("Expected character");let r=0,i=n.indexOf(e);for(;i!==-1;)r++,i=n.indexOf(e,i+e.length);return r}function kr(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}const Cr={}.hasOwnProperty,yr=function(t,e,n,r){let i,l;typeof e=="string"||e instanceof RegExp?(l=[[e,n]],i=r):(l=e,i=n),i||(i={});const o=mn(i.ignore||[]),s=xr(l);let a=-1;for(;++a<s.length;)gn(t,"text",c);return t;function c(h,d){let f=-1,p;for(;++f<d.length;){const g=d[f];if(o(g,p?p.children.indexOf(g):void 0,p))return;p=g}if(p)return u(h,d)}function u(h,d){const f=d[d.length-1],p=s[a][0],g=s[a][1];let w=0;const b=f.children.indexOf(h);let C=!1,x=[],A;p.lastIndex=0;let v=p.exec(h.value);for(;v;){A=v.index;const B={index:v.index,input:v.input,stack:[...d,h]};let S=g(...v,B);if(typeof S=="string"&&(S=S.length>0?{type:"text",value:S}:void 0),S!==!1&&(w!==A&&x.push({type:"text",value:h.value.slice(w,A)}),Array.isArray(S)?x.push(...S):S&&x.push(S),w=A+v[0].length,C=!0),!p.global)break;v=p.exec(h.value)}return C?(w<h.value.length&&x.push({type:"text",value:h.value.slice(w)}),f.children.splice(b,1,...x)):x=[h],b+x.length}};function xr(t){const e=[];if(typeof t!="object")throw new TypeError("Expected array or object as schema");if(Array.isArray(t)){let n=-1;for(;++n<t.length;)e.push([le(t[n][0]),oe(t[n][1])])}else{let n;for(n in t)Cr.call(t,n)&&e.push([le(n),oe(t[n])])}return e}function le(t){return typeof t=="string"?new RegExp(kr(t),"g"):t}function oe(t){return typeof t=="function"?t:()=>t}const Lt="phrasing",Tt=["autolink","link","image","label"],vr={transforms:[Tr],enter:{literalAutolink:Sr,literalAutolinkEmail:Rt,literalAutolinkHttp:Rt,literalAutolinkWww:Rt},exit:{literalAutolink:Lr,literalAutolinkEmail:$r,literalAutolinkHttp:Mr,literalAutolinkWww:Dr}},Ar={unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Lt,notInConstruct:Tt},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Lt,notInConstruct:Tt},{character:":",before:"[ps]",after:"\\/",inConstruct:Lt,notInConstruct:Tt}]};function Sr(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function Rt(t){this.config.enter.autolinkProtocol.call(this,t)}function Mr(t){this.config.exit.autolinkProtocol.call(this,t)}function Dr(t){this.config.exit.data.call(this,t);const e=this.stack[this.stack.length-1];e.url="http://"+this.sliceSerialize(t)}function $r(t){this.config.exit.autolinkEmail.call(this,t)}function Lr(t){this.exit(t)}function Tr(t){yr(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,Rr],[/([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/g,Er]],{ignore:["link","linkReference"]})}function Rr(t,e,n,r,i){let l="";if(!Je(i)||(/^w/i.test(e)&&(n=e+n,e="",l="http://"),!zr(n)))return!1;const o=Fr(n+r);if(!o[0])return!1;const s={type:"link",title:null,url:l+e+o[0],children:[{type:"text",value:e+o[0]}]};return o[1]?[s,{type:"text",value:o[1]}]:s}function Er(t,e,n,r){return!Je(r,!0)||/[_-\d]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+n,children:[{type:"text",value:e+"@"+n}]}}function zr(t){const e=t.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function Fr(t){const e=/[!"&'),.:;<>?\]}]+$/.exec(t);let n,r,i,l;if(e)for(t=t.slice(0,e.index),l=e[0],n=l.indexOf(")"),r=ie(t,"("),i=ie(t,")");n!==-1&&r>i;)t+=l.slice(0,n+1),l=l.slice(n+1),n=l.indexOf(")"),i++;return[t,l]}function Je(t,e){const n=t.input.charCodeAt(t.index-1);return(t.index===0||Pt(n)||Ht(n))&&(!e||n!==47)}function Nr(){return{enter:{gfmFootnoteDefinition:t,gfmFootnoteDefinitionLabelString:e,gfmFootnoteCall:i,gfmFootnoteCallString:l},exit:{gfmFootnoteDefinition:r,gfmFootnoteDefinitionLabelString:n,gfmFootnoteCall:s,gfmFootnoteCallString:o}};function t(a){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},a)}function e(){this.buffer()}function n(a){const c=this.resume(),u=this.stack[this.stack.length-1];u.label=c,u.identifier=st(this.sliceSerialize(a)).toLowerCase()}function r(a){this.exit(a)}function i(a){this.enter({type:"footnoteReference",identifier:"",label:""},a)}function l(){this.buffer()}function o(a){const c=this.resume(),u=this.stack[this.stack.length-1];u.label=c,u.identifier=st(this.sliceSerialize(a)).toLowerCase()}function s(a){this.exit(a)}}function Ir(){return t.peek=e,{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:n,footnoteReference:t}};function t(r,i,l,o){const s=bt(o);let a=s.move("[^");const c=l.enter("footnoteReference"),u=l.enter("reference");return a+=s.move(Yt(l,Qt(r),{...s.current(),before:a,after:"]"})),u(),c(),a+=s.move("]"),a}function e(){return"["}function n(r,i,l,o){const s=bt(o);let a=s.move("[^");const c=l.enter("footnoteDefinition"),u=l.enter("label");return a+=s.move(Yt(l,Qt(r),{...s.current(),before:a,after:"]"})),u(),a+=s.move("]:"+(r.children&&r.children.length>0?" ":"")),s.shift(4),a+=s.move(wn(bn(r,l,s.current()),h)),c(),a;function h(d,f,p){return f?(p?"":"    ")+d:d}}}const Or={canContainEols:["delete"],enter:{strikethrough:Pr},exit:{strikethrough:Hr}},_r={unsafe:[{character:"~",inConstruct:"phrasing"}],handlers:{delete:Ze}};Ze.peek=Br;function Pr(t){this.enter({type:"delete",children:[]},t)}function Hr(t){this.exit(t)}function Ze(t,e,n,r){const i=bt(r),l=n.enter("emphasis");let o=i.move("~~");return o+=Oe(t,n,{...i.current(),before:o,after:"~"}),o+=i.move("~~"),l(),o}function Br(){return"~"}function Wr(t,e={}){const n=(e.align||[]).concat(),r=e.stringLength||Ur,i=[],l=[],o=[],s=[];let a=0,c=-1;for(;++c<t.length;){const p=[],g=[];let w=-1;for(t[c].length>a&&(a=t[c].length);++w<t[c].length;){const b=jr(t[c][w]);if(e.alignDelimiters!==!1){const C=r(b);g[w]=C,(s[w]===void 0||C>s[w])&&(s[w]=C)}p.push(b)}l[c]=p,o[c]=g}let u=-1;if(typeof n=="object"&&"length"in n)for(;++u<a;)i[u]=ae(n[u]);else{const p=ae(n);for(;++u<a;)i[u]=p}u=-1;const h=[],d=[];for(;++u<a;){const p=i[u];let g="",w="";p===99?(g=":",w=":"):p===108?g=":":p===114&&(w=":");let b=e.alignDelimiters===!1?1:Math.max(1,s[u]-g.length-w.length);const C=g+"-".repeat(b)+w;e.alignDelimiters!==!1&&(b=g.length+b+w.length,b>s[u]&&(s[u]=b),d[u]=b),h[u]=C}l.splice(1,0,h),o.splice(1,0,d),c=-1;const f=[];for(;++c<l.length;){const p=l[c],g=o[c];u=-1;const w=[];for(;++u<a;){const b=p[u]||"";let C="",x="";if(e.alignDelimiters!==!1){const A=s[u]-(g[u]||0),v=i[u];v===114?C=" ".repeat(A):v===99?A%2?(C=" ".repeat(A/2+.5),x=" ".repeat(A/2-.5)):(C=" ".repeat(A/2),x=C):x=" ".repeat(A)}e.delimiterStart!==!1&&!u&&w.push("|"),e.padding!==!1&&!(e.alignDelimiters===!1&&b==="")&&(e.delimiterStart!==!1||u)&&w.push(" "),e.alignDelimiters!==!1&&w.push(C),w.push(b),e.alignDelimiters!==!1&&w.push(x),e.padding!==!1&&w.push(" "),(e.delimiterEnd!==!1||u!==a-1)&&w.push("|")}f.push(e.delimiterEnd===!1?w.join("").replace(/ +$/,""):w.join(""))}return f.join(`
`)}function jr(t){return t==null?"":String(t)}function Ur(t){return t.length}function ae(t){const e=typeof t=="string"?t.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}const Vr={enter:{table:qr,tableData:se,tableHeader:se,tableRow:Gr},exit:{codeText:Xr,table:Kr,tableData:Et,tableHeader:Et,tableRow:Et}};function qr(t){const e=t._align;this.enter({type:"table",align:e.map(n=>n==="none"?null:n),children:[]},t),this.setData("inTable",!0)}function Kr(t){this.exit(t),this.setData("inTable")}function Gr(t){this.enter({type:"tableRow",children:[]},t)}function Et(t){this.exit(t)}function se(t){this.enter({type:"tableCell",children:[]},t)}function Xr(t){let e=this.resume();this.getData("inTable")&&(e=e.replace(/\\([\\|])/g,Jr));const n=this.stack[this.stack.length-1];n.value=e,this.exit(t)}function Jr(t,e){return e==="|"?e:t}function Zr(t){const e=t||{},n=e.tableCellPadding,r=e.tablePipeAlign,i=e.stringLength,l=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{table:o,tableRow:s,tableCell:a,inlineCode:d}};function o(f,p,g,w){return c(u(f,g,w),f.align)}function s(f,p,g,w){const b=h(f,g,w),C=c([b]);return C.slice(0,C.indexOf(`
`))}function a(f,p,g,w){const b=g.enter("tableCell"),C=g.enter("phrasing"),x=Oe(f,g,{...w,before:l,after:l});return C(),b(),x}function c(f,p){return Wr(f,{align:p,alignDelimiters:r,padding:n,stringLength:i})}function u(f,p,g){const w=f.children;let b=-1;const C=[],x=p.enter("table");for(;++b<w.length;)C[b]=h(w[b],p,g);return x(),C}function h(f,p,g){const w=f.children;let b=-1;const C=[],x=p.enter("tableRow");for(;++b<w.length;)C[b]=a(w[b],f,p,g);return x(),C}function d(f,p,g){let w=kn(f,p,g);return g.stack.includes("tableCell")&&(w=w.replace(/\|/g,"\\$&")),w}}const Yr={exit:{taskListCheckValueChecked:ce,taskListCheckValueUnchecked:ce,paragraph:ti}},Qr={unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:ei}};function ce(t){const e=this.stack[this.stack.length-2];e.checked=t.type==="taskListCheckValueChecked"}function ti(t){const e=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1],r=e.children,i=n.children[0];let l=-1,o;if(e&&e.type==="listItem"&&typeof e.checked=="boolean"&&i&&i.type==="text"){for(;++l<r.length;){const s=r[l];if(s.type==="paragraph"){o=s;break}}o===n&&(i.value=i.value.slice(1),i.value.length===0?n.children.shift():n.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,n.position.start=Object.assign({},i.position.start)))}this.exit(t)}function ei(t,e,n,r){const i=t.children[0],l=typeof t.checked=="boolean"&&i&&i.type==="paragraph",o="["+(t.checked?"x":" ")+"] ",s=bt(r);l&&s.move(o);let a=Cn(t,e,n,{...r,...s.current()});return l&&(a=a.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),a;function c(u){return u+o}}function ni(){return[vr,Nr(),Or,Vr,Yr]}function ri(t){return{extensions:[Ar,Ir(),_r,Zr(t),Qr]}}function ii(t={}){const e=this.data();n("micromarkExtensions",br(t)),n("fromMarkdownExtensions",ni()),n("toMarkdownExtensions",ri(t));function n(r,i){(e[r]?e[r]:e[r]=[]).push(i)}}const Ye=t=>`footnote-ref-${t}`,Qe=t=>`footnote-def-${t}`,li=new Y("MILKDOWN_FOOTNOTE_DEF_INPUT"),ue=z("ModifyFootnoteDef"),oi=Ut(t=>{const e="footnote_definition",n="footnoteDefinition";return{id:e,schema:r=>({group:"block",content:"block+",defining:!0,attrs:{label:{default:""}},parseDOM:[{tag:`div[data-type="${e}"]`,getAttrs:i=>{if(!(i instanceof HTMLElement))throw Bt(i);return{label:i.dataset.label}},contentElement:"dd"}],toDOM:i=>{const l=i.attrs.label,o=t.getClassName(i.attrs,"footnote-definition"),s=document.createElement("dt");s.textContent=`[${l}]:`,s.onclick=()=>{const c=r.get(kt),u=Ct.create(c.state.doc,c.state.selection.from-2);c.dispatch(c.state.tr.setSelection(u))};const a=document.createElement("a");return a.href=`#${Ye(l)}`,a.contentEditable="false",a.textContent="\u21A9",a.onmousedown=c=>{c.preventDefault()},["div",{class:o,"data-label":l,"data-type":e,id:Qe(l)},["div",{class:"footnote-definition_content"},s,["dd",0]],["div",{class:"footnote-definition_anchor"},a]]},parseMarkdown:{match:({type:i})=>i===n,runner:(i,l,o)=>{i.openNode(o,{label:l.label}).next(l.children).closeNode()}},toMarkdown:{match:i=>i.type.name===e,runner:(i,l)=>{i.openNode(n,void 0,{label:l.attrs.label,identifier:l.attrs.label}).next(l.content).closeNode()}}}),commands:r=>[R(ue,(i="")=>(l,o)=>{const s=et(l.selection,r);if(!s)return!1;const{tr:a}=l,c=a.setNodeMarkup(s.pos,void 0,{...s.node.attrs,label:i});return o==null||o(c.setSelection(Ct.create(c.doc,s.pos))),!0})],inputRules:r=>[He(/(?:\[\^)([^:]+)(?::)$/,r,i=>{var l;return{label:(l=i[1])!=null?l:"footnote"}},()=>!1)],prosePlugins:(r,i)=>[new it({key:li,view:l=>{const o=t.themeManager.get("input-chip",{width:"12em",placeholder:"Input Footnote Label",onUpdate:u=>{i.get(_e).call(ue,u)},isBindMode:!0});if(!o)return{};const s=u=>Boolean(r&&et(u.state.selection,r)),a=u=>{const h=et(u.state.selection,r);return h?h.node.attrs.label:void 0},c=u=>{!u.editable||(s(u)?(o.show(u),o.update(a(u))):o.hide())};return o.init(l),c(l),{update:(u,h)=>{(h==null?void 0:h.doc.eq(u.state.doc))&&h.selection.eq(u.state.selection)||c(u)},destroy:()=>{o.destroy()}}}})]}}),he=z("ModifyFootnoteRef"),ai=new Y("MILKDOWN_FOOTNOTE_REF_INPUT"),si=Ut(t=>{const e="footnote_reference";return{id:e,schema:n=>({group:"inline",inline:!0,atom:!0,attrs:{label:{default:""}},parseDOM:[{tag:`sup[data-type="${e}"]`,getAttrs:r=>{if(!(r instanceof HTMLElement))throw Bt(r);return{label:r.dataset.label}}}],toDOM:r=>{const i=r.attrs.label,l=document.createElement("a"),o=`#${Qe(i)}`;return l.href=o,l.textContent=`[${i}]`,l.onclick=s=>{n.get(kt).editable&&s.preventDefault()},l.ondblclick=()=>{n.get(kt).editable&&(window.location.href=o)},["sup",{"data-label":i,"data-type":e,id:Ye(i)},l]},parseMarkdown:{match:({type:r})=>r==="footnoteReference",runner:(r,i,l)=>{r.addNode(l,{label:i.label})}},toMarkdown:{match:r=>r.type.name===e,runner:(r,i)=>{r.addNode("footnoteReference",void 0,void 0,{label:i.attrs.label,identifier:i.attrs.label})}}}),commands:n=>[R(he,(r="")=>(i,l)=>{const o=et(i.selection,n);if(!o)return!1;const{tr:s}=i,a=s.setNodeMarkup(o.pos,void 0,{...o.node.attrs,label:r});return l==null||l(a.setSelection(Ct.create(a.doc,o.pos))),!0})],inputRules:n=>[new Be(/(?:\[\^)([^\]]+)(?:\])$/,(r,i,l,o)=>{const s=r.doc.resolve(l),a=s.index(),c=r.doc.resolve(o);if(!s.parent.canReplaceWith(a,c.index(),n))return null;const u=i[1];return r.tr.replaceRangeWith(l,o,n.create({label:u}))})],prosePlugins:(n,r)=>{const i=t.themeManager.get("input-chip",{width:"12em",placeholder:"Input Footnote Label",onUpdate:a=>{r.get(_e).call(he,a)},isBindMode:!0});if(!i)return[];const l=a=>Boolean(n&&et(a.state.selection,n)),o=a=>{const c=et(a.state.selection,n);return c?c.node.attrs.label:void 0},s=a=>{!a.editable||(l(a)?(i.show(a),i.update(o(a))):i.hide())};return[new it({key:ai,view:a=>(i.init(a),s(a),{update:(c,u)=>{(u==null?void 0:u.doc.eq(c.state.doc))&&u.selection.eq(c.state.selection)||s(c)},destroy:()=>{i.destroy()}})})]}}}),tn=new WeakMap,ci=t=>tn.get(t),ui=(t,e)=>(tn.set(t,e),e);class pe{constructor(e,n,r,i){this.left=e,this.top=n,this.right=r,this.bottom=i}}class y{constructor(e,n,r,i){this.width=e,this.height=n,this.map=r,this.problems=i,this.width=e,this.height=n,this.map=r,this.problems=i}findCell(e){for(let n=0;n<this.map.length;n++){const r=this.map[n];if(r!=e)continue;const i=n%this.width,l=n/this.width|0;let o=i+1,s=l+1;for(let a=1;o<this.width&&this.map[n+a]==r;a++)o++;for(let a=1;s<this.height&&this.map[n+this.width*a]==r;a++)s++;return new pe(i,l,o,s)}throw new RangeError("No cell with offset "+e+" found")}colCount(e){for(let n=0;n<this.map.length;n++)if(this.map[n]==e)return n%this.width;throw new RangeError("No cell with offset "+e+" found")}nextCell(e,n,r){const{left:i,right:l,top:o,bottom:s}=this.findCell(e);return n=="horiz"?(r<0?i==0:l==this.width)?void 0:this.map[o*this.width+(r<0?i-1:l)]:(r<0?o==0:s==this.height)?void 0:this.map[i+this.width*(r<0?o-1:s)]}rectBetween(e,n){const{left:r,right:i,top:l,bottom:o}=this.findCell(e),{left:s,right:a,top:c,bottom:u}=this.findCell(n);return new pe(Math.min(r,s),Math.min(l,c),Math.max(i,a),Math.max(o,u))}cellsInRect(e){const n=[],r={};for(let i=e.top;i<e.bottom;i++)for(let l=e.left;l<e.right;l++){const o=i*this.width+l,s=this.map[o];r[s]||(r[s]=!0,(l!=e.left||!l||this.map[o-1]!=s)&&(i!=e.top||!i||this.map[o-this.width]!=s)&&n.push(s))}return n}positionAt(e,n,r){for(let i=0,l=0;;i++){const o=l+r.child(i).nodeSize;if(i==e){let s=n+e*this.width;const a=(e+1)*this.width;for(;s<a&&this.map[s]<l;)s++;return s==a?o-1:this.map[s]}l=o}}static get(e){return ci(e)||ui(e,hi(e))}}function hi(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);const e=pi(t),n=t.childCount,r=[],i=[];let l=0,o;for(let c=0,u=e*n;c<u;c++)r[c]=0;for(let c=0,u=0;c<n;c++){const h=t.child(c);u++;for(let p=0;;p++){for(;l<r.length&&r[l]!=0;)l++;if(p==h.childCount)break;const g=h.child(p),{colspan:w,rowspan:b,colwidth:C}=g.attrs;for(let x=0;x<b;x++){if(x+c>=n){(o||(o=[])).push({type:"overlong_rowspan",pos:u,n:b-x});break}const A=l+x*e;for(let v=0;v<w;v++){r[A+v]==0?r[A+v]=u:(o||(o=[])).push({type:"collision",row:c,pos:u,n:w-v});const B=C&&C[v];if(B){const S=(A+v)%e*2,Q=i[S];Q==null||Q!=B&&i[S+1]==1?(i[S]=B,i[S+1]=1):Q==B&&i[S+1]++}}}l+=w,u+=g.nodeSize}const d=(c+1)*e;let f=0;for(;l<d;)r[l++]==0&&f++;f&&(o||(o=[])).push({type:"missing",row:c,n:f}),u++}const s=new y(e,n,r,o);let a=!1;for(let c=0;!a&&c<i.length;c+=2)i[c]!=null&&i[c+1]<n&&(a=!0);return a&&di(s,i,t),s}function pi(t){let e=-1,n=!1;for(let r=0;r<t.childCount;r++){const i=t.child(r);let l=0;if(n)for(let o=0;o<r;o++){const s=t.child(o);for(let a=0;a<s.childCount;a++){const c=s.child(a);o+c.attrs.rowspan>r&&(l+=c.attrs.colspan)}}for(let o=0;o<i.childCount;o++){const s=i.child(o);l+=s.attrs.colspan,s.attrs.rowspan>1&&(n=!0)}e==-1?e=l:e!=l&&(e=Math.max(e,l))}return e}function di(t,e,n){t.problems||(t.problems=[]);for(let r=0,i={};r<t.map.length;r++){const l=t.map[r];if(i[l])continue;i[l]=!0;const o=n.nodeAt(l);let s=null;for(let a=0;a<o.attrs.colspan;a++){const c=(r+a)%t.width,u=e[c*2];u!=null&&(!o.attrs.colwidth||o.attrs.colwidth[a]!=u)&&((s||(s=fi(o.attrs)))[a]=u)}s&&t.problems.unshift({type:"colwidth mismatch",pos:l,colwidth:s})}}function fi(t){if(t.colwidth)return t.colwidth.slice();const e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}class k extends T{constructor(e,n=e){const r=e.node(-1),i=y.get(r),l=e.start(-1),o=i.rectBetween(e.pos-l,n.pos-l),s=e.node(0),a=i.cellsInRect(o).filter(u=>u!=n.pos-l);a.unshift(n.pos-l);const c=a.map(u=>{const h=r.nodeAt(u),d=u+l+1;return new xn(s.resolve(d),s.resolve(d+h.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=n,this.$anchorCell=e,this.$headCell=n}map(e,n){const r=e.resolve(n.map(this.$anchorCell.pos)),i=e.resolve(n.map(this.$headCell.pos));if(It(r)&&It(i)&&Xt(r,i)){const l=this.$anchorCell.node(-1)!=r.node(-1);return l&&this.isRowSelection()?k.rowSelection(r,i):l&&this.isColSelection()?k.colSelection(r,i):new k(r,i)}return j.between(r,i)}content(){const e=this.$anchorCell.node(-1),n=y.get(e),r=this.$anchorCell.start(-1),i=n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),l={},o=[];for(let a=i.top;a<i.bottom;a++){const c=[];for(let u=a*n.width+i.left,h=i.left;h<i.right;h++,u++){const d=n.map[u];if(!l[d]){l[d]=!0;const f=n.findCell(d);let p=e.nodeAt(d);const g=i.left-f.left,w=f.right-i.right;if(g>0||w>0){let b=p.attrs;g>0&&(b=Z(b,0,g)),w>0&&(b=Z(b,b.colspan-w,w)),f.left<i.left?p=p.type.createAndFill(b):p=p.type.create(b,p.content)}if(f.top<i.top||f.bottom>i.bottom){const b=M(p.attrs,"rowspan",Math.min(f.bottom,i.bottom)-Math.max(f.top,i.top));f.top<i.top?p=p.type.createAndFill(b):p=p.type.create(b,p.content)}c.push(p)}}o.push(e.child(a).copy(P.from(c)))}const s=this.isColSelection()&&this.isRowSelection()?e:o;return new U(P.from(s),1,1)}replace(e,n=U.empty){const r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){const{$from:s,$to:a}=i[o],c=e.mapping.slice(r);e.replace(c.map(s.pos),c.map(a.pos),o?U.empty:n)}const l=T.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);l&&e.setSelection(l)}replaceWith(e,n){this.replace(e,new U(P.from(n),0,0))}forEachCell(e){const n=this.$anchorCell.node(-1),r=y.get(n),i=this.$anchorCell.start(-1),l=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let o=0;o<l.length;o++)e(n.nodeAt(l[o]),i+l[o])}isColSelection(){const e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){const r=y.get(e.node(-1)),i=e.start(-1),l=r.findCell(e.pos-i),o=r.findCell(n.pos-i),s=e.node(0);if(l.top<=o.top){if(l.top>0){const a=r.map[l.left];e=s.resolve(i+a)}if(o.bottom<r.height){const a=r.map[r.width*(r.height-1)+o.right-1];n=s.resolve(i+a)}}else{if(o.top>0){const a=r.map[l.left];n=s.resolve(i+a)}if(l.bottom<r.height){const a=r.map[r.width*(r.height-1)+l.right-1];e=s.resolve(i+a)}}return new k(e,n)}isRowSelection(){const e=y.get(this.$anchorCell.node(-1)),n=this.$anchorCell.start(-1),r=e.colCount(this.$anchorCell.pos-n),i=e.colCount(this.$headCell.pos-n);if(Math.min(r,i)>0)return!1;const l=r+this.$anchorCell.nodeAfter.attrs.colspan,o=i+this.$headCell.nodeAfter.attrs.colspan;return Math.max(l,o)==e.width}eq(e){return e instanceof k&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){const r=y.get(e.node(-1)),i=e.start(-1),l=r.findCell(e.pos-i),o=r.findCell(n.pos-i),s=e.node(0);if(l.left<=o.left){if(l.left>0){const a=r.map[l.top*r.width];e=s.resolve(i+a)}if(o.right<r.width){const a=r.map[r.width*(o.top+1)-1];n=s.resolve(i+a)}}else{if(o.left>0){const a=r.map[o.top*r.width];n=s.resolve(i+a)}if(l.right<r.width){const a=r.map[r.width*(l.top+1)-1];e=s.resolve(i+a)}}return new k(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new k(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){return new k(e.resolve(n),e.resolve(r))}getBookmark(){return new Gt(this.$anchorCell.pos,this.$headCell.pos)}}k.prototype.visible=!1;T.jsonID("cell",k);class Gt{constructor(e,n){this.anchor=e,this.head=n,this.anchor=e,this.head=n}map(e){return new Gt(e.map(this.anchor),e.map(this.head))}resolve(e){const n=e.resolve(this.anchor),r=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&r.index()<r.parent.childCount&&Xt(n,r)?new k(n,r):T.near(r,1)}}function mi(t){if(!(t.selection instanceof k))return null;const e=[];return t.selection.forEachCell((n,r)=>{e.push(Wt.node(r,r+n.nodeSize,{class:"selectedCell"}))}),jt.create(t.doc,e)}function gi({$from:t,$to:e}){if(t.pos==e.pos||t.pos<t.pos-6)return!1;let n=t.pos,r=e.pos,i=t.depth;for(;i>=0&&!(t.after(i+1)<t.end(i));i--,n++);for(let l=e.depth;l>=0&&!(e.before(l+1)>e.start(l));l--,r--);return n==r&&/row|table/.test(t.node(i).type.spec.tableRole)}function wi({$from:t,$to:e}){let n,r;for(let i=t.depth;i>0;i--){const l=t.node(i);if(l.type.spec.tableRole==="cell"||l.type.spec.tableRole==="header_cell"){n=l;break}}for(let i=e.depth;i>0;i--){const l=e.node(i);if(l.type.spec.tableRole==="cell"||l.type.spec.tableRole==="header_cell"){r=l;break}}return n!==r&&e.parentOffset===0}function bi(t,e,n){const r=(e||t).selection,i=(e||t).doc;let l,o;if(r instanceof Ct&&(o=r.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")l=k.create(i,r.from);else if(o=="row"){const s=i.resolve(r.from+1);l=k.rowSelection(s,s)}else if(!n){const s=y.get(r.node),a=r.from+1,c=s.map[s.width*s.height-1],u=a+c;l=k.create(i,a+1,u)}}else r instanceof j&&gi(r)?l=j.create(i,r.from):r instanceof j&&wi(r)&&(l=j.create(i,r.$from.start(),r.$from.end()));return l&&(e||(e=t.tr)).setSelection(l),e}function de(t,e){const n=t.getAttribute("data-colwidth"),r=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map(o=>Number(o)):null,i=Number(t.getAttribute("colspan")||1),l={colspan:i,rowspan:Number(t.getAttribute("rowspan")||1),colwidth:r&&r.length==i?r:null};for(const o in e){const s=e[o].getFromDOM,a=s&&s(t);a!=null&&(l[o]=a)}return l}function fe(t,e){const n={};t.attrs.colspan!=1&&(n.colspan=t.attrs.colspan),t.attrs.rowspan!=1&&(n.rowspan=t.attrs.rowspan),t.attrs.colwidth&&(n["data-colwidth"]=t.attrs.colwidth.join(","));for(const r in e){const i=e[r].setDOMAttr;i&&i(t.attrs[r],n)}return n}function ki(t){const e=t.cellAttributes||{},n={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(const i in e)n[i]={default:e[i].default};const r=n;return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:t.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:t.cellContent,attrs:r,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:i=>de(i,e)}],toDOM(i){return["td",fe(i,e),0]}},table_header:{content:t.cellContent,attrs:r,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:i=>de(i,e)}],toDOM(i){return["th",fe(i,e),0]}}}}function $(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(const n in t.nodes){const r=t.nodes[n],i=r==null?void 0:r.spec.tableRole;i&&(e[i]=r)}}return e}const pt=ki({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:t=>t.style.textAlign||"left",setDOMAttr:(t,e)=>{e.style=`text-align: ${t||"left"}`}}}});function ct(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1))}function It(t){return t.parent.type.spec.tableRole=="row"?t.nodeAfter:null}function Ci(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function Xt(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function en(t,e,n){const r=t.start(-1),i=y.get(t.node(-1)).nextCell(t.pos-r,e,n);return i==null?null:t.node(0).resolve(r+i)}function M(t,e,n){const r={};for(const i in t)r[i]=t[i];return r[e]=n,r}function Z(t,e,n=1){const r=M(t,"colspan",t.colspan-n);if(r.colwidth){const i=r.colwidth;r.colwidth=i.slice(),i.splice(e,n),i.some(l=>l>0)||(r.colwidth=null)}return r}function L(t){const e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function yt(t){const e=t.selection;return e instanceof k?e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell:e.node&&e.node.type.spec.tableRole=="cell"?e.$anchor:ct(e.$head)||yi(e.$head)}function yi(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function xi(t,e,n=1){const r=M(t,"colspan",t.colspan+n);if(r.colwidth){const i=r.colwidth;r.colwidth=i.slice();for(let l=0;l<n;l++)i.splice(e,0,0)}return r}function vi(t,e,n){const r=$(e.type.schema).header_cell;for(let i=0;i<t.height;i++){const l=t.map[n+i*t.width];if(e.nodeAt(l).type!=r)return!1}return!0}const Ai=t=>(e,n)=>{if(!L(e))return!1;const{$head:r}=e.selection,i=r.after(),l=e.tr.replaceWith(i,i,t.createAndFill());return l.setSelection(T.near(l.doc.resolve(i),1)),n==null||n(l.scrollIntoView()),!0};function rt(t){const e=t.selection,n=yt(t),r=n.node(-1),i=n.start(-1),l=y.get(r);let o;return e instanceof k?o=l.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):o=l.findCell(n.pos-i),o.tableStart=i,o.map=l,o.table=r,o}function nn(t,{map:e,tableStart:n,table:r},i){e=e,r=r,n=n;let l=i>0?-1:0;vi(e,r,i+l)&&(l=i==0||i==e.width?null:0);for(let o=0;o<e.height;o++){const s=o*e.width+i;if(i>0&&i<e.width&&e.map[s-1]==e.map[s]){const a=e.map[s],c=r.nodeAt(a);t.setNodeMarkup(t.mapping.map(n+a),null,xi(c.attrs,i-e.colCount(a))),o+=c.attrs.rowspan-1}else{const a=e.map[s+l],c=l==null?$(r.type.schema).cell:r.nodeAt(a).type,u=e.positionAt(o,i,r);t.insert(t.mapping.map(n+u),c.createAndFill())}}return t}const Si=(t,e)=>{if(!L(t))return!1;if(e){const n=rt(t);e(nn(t.tr,n,n.left))}return!0},Mi=(t,e)=>{if(!L(t))return!1;if(e){const n=rt(t);e(nn(t.tr,n,n.right))}return!0};function Di(t,{map:e,table:n,tableStart:r},i){e=e,n=n,r=r;const l=t.mapping.maps.length;for(let o=0;o<e.height;){const s=o*e.width+i,a=e.map[s],c=n.nodeAt(a);if(i>0&&e.map[s-1]==a||i<e.width-1&&e.map[s+1]==a)t.setNodeMarkup(t.mapping.slice(l).map(r+a),null,Z(c.attrs,i-e.colCount(a)));else{const u=t.mapping.slice(l).map(r+a);t.delete(u,u+c.nodeSize)}o+=c.attrs.rowspan}}const $i=(t,e)=>{if(!L(t))return!1;if(e){const n=rt(t),r=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let i=n.right-1;Di(r,n,i),i!=n.left;i--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=y.get(n.table);e(r)}return!0};function Li(t,{map:e,tableStart:n,table:r},i){e=e,r=r,n=n;let l=0;for(let a=0;a<i;a++)l+=r.child(a).nodeSize;const o=l+r.child(i).nodeSize,s=t.mapping.maps.length;t.delete(l+n,o+n);for(let a=0,c=i*e.width;a<e.width;a++,c++){const u=e.map[c];if(i>0&&u==e.map[c-e.width]){const h=r.nodeAt(u).attrs;t.setNodeMarkup(t.mapping.slice(s).map(u+n),null,M(h,"rowspan",h.rowspan-1)),a+=h.colspan-1}else if(i<e.width&&u==e.map[c+e.width]){const h=r.nodeAt(u),d=h.type.create(M(h.attrs,"rowspan",h.attrs.rowspan-1),h.content),f=e.positionAt(i+1,a,r);t.insert(t.mapping.slice(s).map(n+f),d),a+=h.attrs.colspan-1}}}const Ti=(t,e)=>{if(!L(t))return!1;if(e){const n=rt(t),r=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let i=n.bottom-1;Li(r,n,i),i!=n.top;i--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=y.get(n.table);e(r)}return!0};function zt(t,e){return(n,r)=>{if(!L(n))return!1;const i=yt(n);if(i.nodeAfter.attrs[t]===e)return!1;if(r){const l=n.tr;n.selection instanceof k?n.selection.forEachCell((o,s)=>{o.attrs[t]!==e&&l.setNodeMarkup(s,null,M(o.attrs,t,e))}):l.setNodeMarkup(i.pos,null,M(i.nodeAfter.attrs,t,e)),r(l)}return!0}}function Ri(t,e){if(e<0){const n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let r=t.index(-1)-1,i=t.before();r>=0;r--){const l=t.node(-1).child(r);if(l.childCount)return i-1-l.lastChild.nodeSize;i-=l.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;const n=t.node(-1);for(let r=t.indexAfter(-1),i=t.after();r<n.childCount;r++){const l=n.child(r);if(l.childCount)return i+1;i+=l.nodeSize}}}function me(t){return(e,n)=>{if(!L(e))return!1;const r=Ri(yt(e),t);if(r==null)return!1;if(n){const i=e.doc.resolve(r);n(e.tr.setSelection(j.between(i,Ci(i))).scrollIntoView())}return!0}}const Ei=(t,e)=>{const n=t.selection.$anchor;for(let r=n.depth;r>0;r--)if(n.node(r).type.spec.tableRole=="table")return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1},xt=t=>vn(e=>e.type.spec.tableRole==="table")(t),zi=t=>e=>{const n=xt(e);if(!n)return;const r=y.get(n.node);if(!(t<0||t>=r.width))return r.cellsInRect({left:t,right:t+1,top:0,bottom:r.height}).map(i=>{const l=n.node.nodeAt(i);if(!l)return;const o=i+n.start;return{pos:o,start:o+1,node:l}}).filter(i=>i!=null)},Fi=t=>e=>{const n=xt(e);if(!n)return;const r=y.get(n.node);if(!(t<0||t>=r.height))return r.cellsInRect({left:0,right:r.width,top:t,bottom:t+1}).map(i=>{const l=n.node.nodeAt(i);if(!l)return;const o=i+n.start;return{pos:o,start:o+1,node:l}}).filter(i=>i!=null)},ge=(t,e=3,n=3)=>{const{cell:r,header_cell:i,row:l,table:o}=$(t),s=Array(n).fill(0).map(()=>r.createAndFill(null)),a=Array(n).fill(0).map(()=>i.createAndFill(null)),c=Array(e).fill(0).map((u,h)=>l.create(null,h===0?a:s));return o.create(null,c)},we=t=>e=>n=>{const r=xt(n.selection),i=t==="row";if(r){const l=y.get(r.node);if(e>=0&&e<(i?l.height:l.width)){const o=l.positionAt(i?e:l.height-1,i?l.width-1:e,r.node),s=n.doc.resolve(r.start+o),a=i?k.rowSelection:k.colSelection,c=l.positionAt(i?e:0,i?0:e,r.node),u=n.doc.resolve(r.start+c);return Pe(n.setSelection(a(s,u)))}}return n},Ni=t=>{const e=xt(t);if(!e)return;const n=y.get(e.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map(r=>{const i=e.node.nodeAt(r),l=r+e.start;return{pos:l,start:l+1,node:i}})},Ii=t=>{const e=Ni(t.selection);if(e&&e[0]){const n=t.doc.resolve(e[0].pos),r=e[e.length-1];if(r){const i=t.doc.resolve(r.pos);return Pe(t.setSelection(new k(i,n)))}}return t};function be(t,{map:e,tableStart:n,table:r},i){const l=Array(i).fill(0).reduce((c,u,h)=>c+r.child(h).nodeSize,n),{cell:o,row:s}=$(r.type.schema),a=Array(e.width).fill(0).map((c,u)=>{const h=r.nodeAt(e.map[u]);return o.createAndFill({alignment:h==null?void 0:h.attrs.alignment})});return t.insert(l,s.create(null,a)),t}const F=t=>t.state.selection,Oi=t=>{const e=y.get(t.$anchorCell.node(-1)),n=t.$anchorCell.start(-1),r=e.cellsInRect({left:0,right:e.width,top:0,bottom:1}),i=e.cellsInRect(e.rectBetween(t.$anchorCell.pos-n,t.$headCell.pos-n));for(let l=0,o=r.length;l<o;l++)if(i.indexOf(r[l])===-1)return!1;return!0},_i=(t,e)=>{Object.values(t).forEach(n=>{var r;if((r=n.disable)!=null&&r.call(n,e)){n.$.classList.add("hide");return}n.$.classList.remove("hide")})},Pi=t=>{var e,n,r,i,l,o,s,a;return{[0]:{$:(e=t.get(I).get(O,"leftArrow"))==null?void 0:e.dom,command:()=>Si,disable:c=>!F(c).isColSelection()},[1]:{$:(n=t.get(I).get(O,"rightArrow"))==null?void 0:n.dom,command:()=>Mi,disable:c=>!F(c).isColSelection()},[2]:{$:(r=t.get(I).get(O,"upArrow"))==null?void 0:r.dom,command:()=>(c,u)=>{if(!L(c))return!1;if(u){const h=rt(c);u(be(c.tr,h,h.top))}return!0},disable:c=>!F(c).isRowSelection()||F(c).$head.parent.type.name==="table_header"},[3]:{$:(i=t.get(I).get(O,"downArrow"))==null?void 0:i.dom,command:()=>(c,u)=>{if(!L(c))return!1;if(u){const h=rt(c);u(be(c.tr,h,h.bottom))}return!0},disable:c=>!F(c).isRowSelection()},[4]:{$:(l=t.get(I).get(O,"alignLeft"))==null?void 0:l.dom,command:()=>zt("alignment","left"),disable:c=>!F(c).isColSelection()},[5]:{$:(o=t.get(I).get(O,"alignCenter"))==null?void 0:o.dom,command:()=>zt("alignment","center"),disable:c=>!F(c).isColSelection()},[6]:{$:(s=t.get(I).get(O,"alignRight"))==null?void 0:s.dom,command:()=>zt("alignment","right"),disable:c=>!F(c).isColSelection()},[7]:{$:(a=t.get(I).get(O,"delete"))==null?void 0:a.dom,command:(c,u)=>{const h=F(u),d=h.isColSelection(),f=h.isRowSelection();return d&&f?Ei:d?$i:Ti},disable:c=>{const u=F(c);return u.isRowSelection()?u.isColSelection()?!1:Oi(u):!1}}}},Hi=(t,e)=>{const{selection:n}=t.state,r=n.isColSelection(),i=n.isRowSelection();$n(t,e,(l,o,s)=>{const a=e.parentElement;if(!a)throw Rn();let c=i?l.left-s.left-o.width/2-8:l.left-s.left+(l.width-o.width)/2;const u=l.top-s.top-o.height-(r?14:0)-14+a.scrollTop;return c<0&&(c=0),[u,c]})};var E=(t=>(t.Left="Left",t.Top="Top",t.Point="Point",t))(E||{});const Bi=(t,{css:e,injectGlobal:n})=>{const r=Ln(t),i=t.get(ee,"radius"),l=t.get(ee,"lineWidth");return n`
        .milkdown {
            .tableWrapper {
                table {
                    width: calc(100% - 32px) !important;
                    margin: 16px 0 16px 16px !important;

                    .milkdown-cell-left,
                    .milkdown-cell-point,
                    .milkdown-cell-top {
                        position: absolute;

                        &::after {
                            cursor: pointer;
                            position: absolute;
                            top: 0;
                            left: 0;
                            height: 100%;
                            width: 100%;
                            display: block;
                            transition: all 0.2s ease-in-out;
                            background: ${r("secondary",.12)};
                            content: '';
                        }

                        &:hover::after {
                            background: ${r("secondary",.38)};
                        }
                    }

                    .milkdown-cell-left {
                        left: -14px;
                        top: 0;
                        bottom: 0;
                        width: 8px;
                    }

                    .milkdown-cell-top {
                        left: 0;
                        right: 0;
                        top: -14px;
                        height: 8px;
                    }

                    .milkdown-cell-point {
                        left: -18px;
                        top: -18px;
                        width: 16px;
                        height: 16px;

                        .icon {
                            position: absolute;
                            top: 0;
                            bottom: 0;
                            left: 0;
                            right: 0;
                        }
                    }
                }
            }
        }
    `,e`
        display: inline-flex;
        cursor: pointer;
        z-index: 2;

        justify-content: space-evenly;

        position: absolute;

        border-radius: ${i};

        ${t.get(An,void 0)};
        ${t.get(Sn,void 0)};

        overflow: hidden;
        background: ${r("surface")};

        .icon {
            position: relative;
            color: ${r("solid",.87)};

            width: 48px;
            line-height: 48px;
            text-align: center;
            transition: all 0.4s ease-in-out;

            &:hover {
                background-color: ${r("secondary",.12)};
            }

            &.active {
                color: ${r("primary")};
            }

            &:not(:last-child)::after {
                content: '';
                position: absolute;
                right: 0;
                top: 0;
                width: ${l};
                bottom: 0;
                background: ${r("line")};
            }
        }

        &.hide,
        .hide {
            display: none;
        }
    `},Wi=t=>{switch(t){case E.Left:return"milkdown-cell-left";case E.Top:return"milkdown-cell-top";case E.Point:default:return"milkdown-cell-point"}};function Ft(t,e,n,r=0){return Wt.widget(e.pos+1,i=>{var l;const o=document.createElement("div");return o.classList.add(Wi(n)),n===E.Point&&o.appendChild((l=t.get(I).get(O,"select"))==null?void 0:l.dom),o.addEventListener("mousedown",s=>{if(i)switch(s.preventDefault(),n){case E.Point:{i.dispatch(Ii(i.state.tr));return}case E.Left:{i.dispatch(we("row")(r)(i.state.tr));return}case E.Top:{i.dispatch(we("col")(r)(i.state.tr));return}}}),o})}const ji=(t,e)=>new it({key:new Y("MILKDOWN_TABLE_OP"),props:{decorations:n=>{const r=[],i=zi(0)(n.selection);if(!i)return null;const l=Fi(0)(n.selection);if(!l)return null;const[o]=i;return r.push(Ft(t,o,E.Point)),i.forEach((s,a)=>{r.push(Ft(t,s,E.Left,a))}),l.forEach((s,a)=>{r.push(Ft(t,s,E.Top,a))}),jt.create(n.doc,r)}},view:n=>{var r;const i=Object.fromEntries(Object.entries(Pi(t)).filter(([,a])=>a.$!=null)),l=document.createElement("div");e.themeManager.onFlush(()=>{const a=e.getStyle(c=>Bi(e.themeManager,c));a&&l.classList.add(a)}),l.classList.add("table-tooltip","hide"),Object.values(i).forEach(({$:a})=>l.appendChild(a)),(r=n.dom.parentNode)==null||r.appendChild(l);const o=a=>{!n||(a.stopPropagation(),a.preventDefault(),Object.values(i).forEach(({$:c,command:u})=>{c.contains(a.target)&&u(a,n)(n.state,n.dispatch,n)}))},s=()=>{l.classList.add("hide")};return l.addEventListener("mousedown",o),{update:(a,c)=>{const u=a.state;if(!((c==null?void 0:c.doc.eq(u.doc))&&c.selection.eq(u.selection))){if(!(u.selection instanceof k)||!a.editable){s();return}if(_i(i,a),Object.values(i).every(({$:h})=>h.classList.contains("hide"))){s();return}l.classList.remove("hide"),Hi(a,l)}},destroy:()=>{l.removeEventListener("mousedown",o),l.remove()}}}}),Ui=t=>t.type.name==="paragraph"&&t.nodeSize===2,Vi=t=>t.type.name==="paragraph",qi=new Y("plugin_autoInsertZeroSpace"),Ki=()=>new it({key:qi,props:{handleDOMEvents:{compositionstart(t){const{state:e,dispatch:n}=t,{tr:r,selection:i}=e,{$from:l}=i;return te.safari&&L(e)&&i.empty&&Ui(l.parent)&&n(r.insertText("\u2060",l.start())),!1},compositionend(t){const{state:e,dispatch:n}=t,{tr:r,selection:i}=e,{$from:l}=i;return te.safari&&L(e)&&i.empty&&Vi(l.parent)&&l.parent.textContent.startsWith("\u2060")&&n(r.delete(l.start(),l.start()+1)),!1}}}});class Gi{constructor(e,n){this.node=e,this.cellMinWidth=n,this.node=e,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Ot(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Ot(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}}function Ot(t,e,n,r,i,l){var o;let s=0,a=!0,c=e.firstChild;const u=t.firstChild;for(let h=0,d=0;h<u.childCount;h++){const{colspan:f,colwidth:p}=u.child(h).attrs;for(let g=0;g<f;g++,d++){const w=i==d?l:p&&p[g],b=w?w+"px":"";s+=w||r,w||(a=!1),c?(c.style.width!=b&&(c.style.width=b),c=c.nextSibling):e.appendChild(document.createElement("col")).style.width=b}}for(;c;){const h=c.nextSibling;(o=c.parentNode)==null||o.removeChild(c),c=h}a?(n.style.width=s+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=s+"px")}const D=new Y("tableColumnResizing");function Xi({handleWidth:t=5,cellMinWidth:e=25,View:n=Gi,lastColumnResizable:r=!0}={}){return new it({key:D,state:{init(i,l){return this.spec.props.nodeViews[$(l.schema).table.name]=o=>new n(o,e),new at(-1,!1)},apply(i,l){return l.apply(i)}},props:{attributes(i){return D.getState(i).activeHandle>-1?{class:"resize-cursor"}:void 0},handleDOMEvents:{mousemove(i,l){Ji(i,l,t,r)},mouseleave(i){Zi(i)},mousedown(i,l){Yi(i,l,e)}},decorations(i){const l=D.getState(i);return l.activeHandle>-1?il(i,l.activeHandle):null},nodeViews:{}}})}class at{constructor(e,n){this.activeHandle=e,this.dragging=n,this.activeHandle=e,this.dragging=n}apply(e){let n=this;const r=e.getMeta(D);if(r&&r.setHandle!=null)return new at(r.setHandle,null);if(r&&r.setDragging!==void 0)return new at(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&e.docChanged){let i=e.mapping.map(n.activeHandle,-1);It(e.doc.resolve(i))||(i=0),n=new at(i,n.dragging)}return n}}function Ji(t,e,n,r){const i=D.getState(t.state);if(!i.dragging){const l=tl(e.target);let o=-1;if(l){const{left:s,right:a}=l.getBoundingClientRect();e.clientX-s<=n?o=ke(t,e,"left"):a-e.clientX<=n&&(o=ke(t,e,"right"))}if(o!=i.activeHandle){if(!r&&o!==-1){const s=t.state.doc.resolve(o),a=s.node(-1),c=y.get(a),u=s.start(-1);if(c.colCount(s.pos-u)+s.nodeAfter.attrs.colspan-1==c.width-1)return}rn(t,o)}}}function Zi(t){const e=D.getState(t.state);e.activeHandle>-1&&!e.dragging&&rn(t,-1)}function Yi(t,e,n){const r=D.getState(t.state);if(r.activeHandle==-1||r.dragging)return!1;const i=t.state.doc.nodeAt(r.activeHandle),l=Qi(t,r.activeHandle,i.attrs);t.dispatch(t.state.tr.setMeta(D,{setDragging:{startX:e.clientX,startWidth:l}}));function o(a){window.removeEventListener("mouseup",o),window.removeEventListener("mousemove",s);const c=D.getState(t.state);c.dragging&&(el(t,c.activeHandle,Ce(c.dragging,a,n)),t.dispatch(t.state.tr.setMeta(D,{setDragging:null})))}function s(a){if(!a.which)return o(a);const c=D.getState(t.state),u=Ce(c.dragging,a,n);nl(t,c.activeHandle,u,n)}return window.addEventListener("mouseup",o),window.addEventListener("mousemove",s),e.preventDefault(),!0}function Qi(t,e,{colspan:n,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const l=t.domAtPos(e);let o=l.node.childNodes[l.offset].offsetWidth,s=n;if(r)for(let a=0;a<n;a++)r[a]&&(o-=r[a],s--);return o/s}function tl(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList.contains("ProseMirror")?null:t.parentNode;return t}function ke(t,e,n){const r=t.posAtCoords({left:e.clientX,top:e.clientY});if(!r)return-1;const{pos:i}=r,l=ct(t.state.doc.resolve(i));if(!l)return-1;if(n=="right")return l.pos;const o=y.get(l.node(-1)),s=l.start(-1),a=o.map.indexOf(l.pos-s);return a%o.width==0?-1:s+o.map[a-1]}function Ce(t,e,n){const r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function rn(t,e){t.dispatch(t.state.tr.setMeta(D,{setHandle:e}))}function el(t,e,n){const r=t.state.doc.resolve(e),i=r.node(-1),l=y.get(i),o=r.start(-1),s=l.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,a=t.state.tr;for(let c=0;c<l.height;c++){const u=c*l.width+s;if(c&&l.map[u]==l.map[u-l.width])continue;const h=l.map[u],{attrs:d}=i.nodeAt(h),f=d.colspan==1?0:s-l.colCount(h);if(d.colwidth&&d.colwidth[f]==n)continue;const p=d.colwidth?d.colwidth.slice():rl(d.colspan);p[f]=n,a.setNodeMarkup(o+h,null,M(d,"colwidth",p))}a.docChanged&&t.dispatch(a)}function nl(t,e,n,r){const i=t.state.doc.resolve(e),l=i.node(-1),o=i.start(-1),s=y.get(l).colCount(i.pos-o)+i.nodeAfter.attrs.colspan-1;let a=t.domAtPos(i.start(-1)).node;for(;a.nodeName!="TABLE";)a=a.parentNode;Ot(l,a.firstChild,a,r,s,n)}function rl(t){const e=[];for(let n=0;n<t;n++)e.push(0);return e}function il(t,e){const n=[],r=t.doc.resolve(e),i=r.node(-1),l=y.get(i),o=r.start(-1),s=l.colCount(r.pos-o)+r.nodeAfter.attrs.colspan;for(let a=0;a<l.height;a++){const c=s+a*l.width-1;if((s==l.width||l.map[c]!=l.map[c+1])&&(a==0||l.map[c-1]!=l.map[c-1-l.width])){const u=l.map[c],h=o+u+i.nodeAt(u).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",n.push(Wt.widget(h,d))}}return jt.create(t.doc,n)}function ll(t){if(!t.size)return null;let{content:e,openStart:n,openEnd:r}=t;for(;e.childCount==1&&(n>0&&r>0||e.firstChild.type.spec.tableRole=="table");)n--,r--,e=e.firstChild.content;const i=e.firstChild,l=i.type.spec.tableRole,o=i.type.schema,s=[];if(l=="row")for(let a=0;a<e.childCount;a++){let c=e.child(a).content;const u=a?0:Math.max(0,n-1),h=a<e.childCount-1?0:Math.max(0,r-1);(u||h)&&(c=_t($(o).row,new U(c,u,h)).content),s.push(c)}else if(l=="cell"||l=="header_cell")s.push(n||r?_t($(o).row,new U(e,n,r)).content:e);else return null;return ol(o,s)}function ol(t,e){const n=[];for(let i=0;i<e.length;i++){const l=e[i];for(let o=l.childCount-1;o>=0;o--){const{rowspan:s,colspan:a}=l.child(o).attrs;for(let c=i;c<i+s;c++)n[c]=(n[c]||0)+a}}let r=0;for(let i=0;i<n.length;i++)r=Math.max(r,n[i]);for(let i=0;i<n.length;i++)if(i>=e.length&&e.push(P.empty),n[i]<r){const l=$(t).cell.createAndFill(),o=[];for(let s=n[i];s<r;s++)o.push(l);e[i]=e[i].append(P.from(o))}return{height:e.length,width:r,rows:e}}function _t(t,e){const n=t.createAndFill();return new Tn(n).replace(0,n.content.size,e).doc}function al({width:t,height:e,rows:n},r,i){if(t!=r){const l=[],o=[];for(let s=0;s<n.length;s++){const a=n[s],c=[];for(let u=l[s]||0,h=0;u<r;h++){let d=a.child(h%a.childCount);u+d.attrs.colspan>r&&(d=d.type.create(Z(d.attrs,d.attrs.colspan,u+d.attrs.colspan-r),d.content)),c.push(d),u+=d.attrs.colspan;for(let f=1;f<d.attrs.rowspan;f++)l[s+f]=(l[s+f]||0)+d.attrs.colspan}o.push(P.from(c))}n=o,t=r}if(e!=i){const l=[];for(let o=0,s=0;o<i;o++,s++){const a=[],c=n[s%e];for(let u=0;u<c.childCount;u++){let h=c.child(u);o+h.attrs.rowspan>i&&(h=h.type.create(M(h.attrs,"rowspan",Math.max(1,i-h.attrs.rowspan)),h.content)),a.push(h)}l.push(P.from(a))}n=l,e=i}return{width:t,height:e,rows:n}}function sl(t,e,n,r,i,l,o){const s=t.doc.type.schema,a=$(s);let c,u;if(i>e.width)for(let h=0,d=0;h<e.height;h++){const f=n.child(h);d+=f.nodeSize;const p=[];let g;f.lastChild==null||f.lastChild.type==a.cell?g=c||(c=a.cell.createAndFill()):g=u||(u=a.header_cell.createAndFill());for(let w=e.width;w<i;w++)p.push(g);t.insert(t.mapping.slice(o).map(d-1+r),p)}if(l>e.height){const h=[];for(let p=0,g=(e.height-1)*e.width;p<Math.max(e.width,i);p++){const w=p>=e.width?!1:n.nodeAt(e.map[g+p]).type==a.header_cell;h.push(w?u||(u=a.header_cell.createAndFill()):c||(c=a.cell.createAndFill()))}const d=a.row.create(null,P.from(h)),f=[];for(let p=e.height;p<l;p++)f.push(d);t.insert(t.mapping.slice(o).map(r+n.nodeSize-2),f)}return!!(c||u)}function ye(t,e,n,r,i,l,o,s){if(o==0||o==e.height)return!1;let a=!1;for(let c=i;c<l;c++){const u=o*e.width+c,h=e.map[u];if(e.map[u-e.width]==h){a=!0;const d=n.nodeAt(h),{top:f,left:p}=e.findCell(h);t.setNodeMarkup(t.mapping.slice(s).map(h+r),null,M(d.attrs,"rowspan",o-f)),t.insert(t.mapping.slice(s).map(e.positionAt(o,p,n)),d.type.createAndFill(M(d.attrs,"rowspan",f+d.attrs.rowspan-o))),c+=d.attrs.colspan-1}}return a}function xe(t,e,n,r,i,l,o,s){if(o==0||o==e.width)return!1;let a=!1;for(let c=i;c<l;c++){const u=c*e.width+o,h=e.map[u];if(e.map[u-1]==h){a=!0;const d=n.nodeAt(h),f=e.colCount(h),p=t.mapping.slice(s).map(h+r);t.setNodeMarkup(p,null,Z(d.attrs,o-f,d.attrs.colspan-(o-f))),t.insert(p+d.nodeSize,d.type.createAndFill(Z(d.attrs,0,o-f))),c+=d.attrs.rowspan-1}}return a}function ve(t,e,n,r,i){let l=n?t.doc.nodeAt(n-1):t.doc,o=y.get(l);const{top:s,left:a}=r,c=a+i.width,u=s+i.height,h=t.tr;let d=0;function f(){l=n?h.doc.nodeAt(n-1):h.doc,o=y.get(l),d=h.mapping.maps.length}sl(h,o,l,n,c,u,d)&&f(),ye(h,o,l,n,a,c,s,d)&&f(),ye(h,o,l,n,a,c,u,d)&&f(),xe(h,o,l,n,s,u,a,d)&&f(),xe(h,o,l,n,s,u,c,d)&&f();for(let p=s;p<u;p++){const g=o.positionAt(p,a,l),w=o.positionAt(p,c,l);h.replace(h.mapping.slice(d).map(g+n),h.mapping.slice(d).map(w+n),new U(i.rows[p-s],0,0))}f(),h.setSelection(new k(h.doc.resolve(n+o.positionAt(s,a,l)),h.doc.resolve(n+o.positionAt(u-1,c-1,l)))),e(h)}const cl=new Y("fix-tables");function ln(t,e,n,r){const i=t.childCount,l=e.childCount;t:for(let o=0,s=0;o<l;o++){const a=e.child(o);for(let c=s,u=Math.min(i,o+3);c<u;c++)if(t.child(c)==a){s=c+1,n+=a.nodeSize;continue t}r(a,n),s<i&&t.child(s).sameMarkup(a)?ln(t.child(s),a,n+1,r):a.nodesBetween(0,a.content.size,r,n+1),n+=a.nodeSize}}function ul(t,e){let n;const r=(i,l)=>{i.type.spec.tableRole=="table"&&(n=hl(t,i,l,n))};return e?e.doc!=t.doc&&ln(e.doc,t.doc,0,r):t.doc.descendants(r),n}function hl(t,e,n,r){const i=y.get(e);if(!i.problems)return r;r||(r=t.tr);const l=[];for(let a=0;a<i.height;a++)l.push(0);for(let a=0;a<i.problems.length;a++){const c=i.problems[a];if(c.type=="collision"){const u=e.nodeAt(c.pos);for(let h=0;h<u.attrs.rowspan;h++)l[c.row+h]+=c.n;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,Z(u.attrs,u.attrs.colspan-c.n,c.n))}else if(c.type=="missing")l[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const u=e.nodeAt(c.pos);r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,M(u.attrs,"rowspan",u.attrs.rowspan-c.n))}else if(c.type=="colwidth mismatch"){const u=e.nodeAt(c.pos);r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,M(u.attrs,"colwidth",c.colwidth))}}let o,s;for(let a=0;a<l.length;a++)l[a]&&(o==null&&(o=a),s=a);for(let a=0,c=n+1;a<i.height;a++){const u=e.child(a),h=c+u.nodeSize,d=l[a];if(d>0){let f="cell";u.firstChild&&(f=u.firstChild.type.spec.tableRole);const p=[];for(let w=0;w<d;w++)p.push($(t.schema)[f].createAndFill());const g=(a==0||o==a-1)&&s==a?c+1:h-1;r.insert(r.mapping.map(g),p)}c=h}return r.setMeta(cl,{fixTables:!0})}const W=new Y("selectingCells");function Ae(t,e){for(;e&&e!=t.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e}function Nt(t,e){const n=t.posAtCoords({left:e.clientX,top:e.clientY});return n&&n?ct(t.state.doc.resolve(n.pos)):null}function pl(t,e){const n=e;if(n.ctrlKey||n.metaKey)return;const r=Ae(t,n.target);let i;if(n.shiftKey&&t.state.selection instanceof k)l(t.state.selection.$anchorCell,n),n.preventDefault();else if(n.shiftKey&&r&&(i=ct(t.state.selection.$anchor))!=null&&Nt(t,n).pos!=i.pos)l(i,n),n.preventDefault();else if(!r)return;function l(a,c){let u=Nt(t,c);const h=W.getState(t.state)==null;if(!u||!Xt(a,u))if(h)u=a;else return;const d=new k(a,u);if(h||!t.state.selection.eq(d)){const f=t.state.tr.setSelection(d);h&&f.setMeta(W,a.pos),t.dispatch(f)}}function o(){t.root.removeEventListener("mouseup",o),t.root.removeEventListener("dragstart",o),t.root.removeEventListener("mousemove",s),W.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(W,-1))}function s(a){const c=W.getState(t.state);let u;if(c!=null)u=t.state.doc.resolve(c);else if(Ae(t,a.target)!=r&&(u=Nt(t,n),!u))return o();u&&l(u,a)}t.root.addEventListener("mouseup",o),t.root.addEventListener("dragstart",o),t.root.addEventListener("mousemove",s)}function dl(t,e){const n=t.state.doc,r=ct(n.resolve(e));return r?(t.dispatch(t.state.tr.setSelection(new k(r))),!0):!1}function gt(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function on(t,e,n){if(!(t.state.selection instanceof j))return null;const{$head:r}=t.state.selection;for(let i=r.depth-1;i>=0;i--){const l=r.node(i);if((n<0?r.index(i):r.indexAfter(i))!=(n<0?0:l.childCount))return null;if(l.type.spec.tableRole=="cell"||l.type.spec.tableRole=="header_cell"){const o=r.before(i),s=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(s)?o:null}}return null}function dt(t,e){return(n,r,i)=>{const l=n.selection;if(l instanceof k)return gt(n,r,T.near(l.$headCell,e));if(t!="horiz"&&!l.empty)return!1;const o=on(i,t,e);if(o==null)return!1;if(t=="horiz")return gt(n,r,T.near(n.doc.resolve(l.head+e),e));{const s=n.doc.resolve(o),a=en(s,t,e);let c;return a?c=T.near(a,1):e<0?c=T.near(n.doc.resolve(s.before(-1)),-1):c=T.near(n.doc.resolve(s.after(-1)),1),gt(n,r,c)}}}function ft(t,e){return(n,r,i)=>{let l=n.selection;if(!(l instanceof k)){const s=on(i,t,e);if(s==null)return!1;l=new k(n.doc.resolve(s))}const o=en(l.$headCell,t,e);return o?gt(n,r,new k(l.$anchorCell,o)):!1}}function mt(t,e){const n=t.selection;if(!(n instanceof k))return!1;if(e){const r=t.tr,i=$(t.schema).cell.createAndFill().content;n.forEachCell((l,o)=>{l.content.eq(i)||r.replace(r.mapping.map(o+1),r.mapping.map(o+l.nodeSize-1),new U(i,0,0))}),r.docChanged&&e(r)}return!0}const fl=yn({ArrowLeft:dt("horiz",-1),ArrowRight:dt("horiz",1),ArrowUp:dt("vert",-1),ArrowDown:dt("vert",1),"Shift-ArrowLeft":ft("horiz",-1),"Shift-ArrowRight":ft("horiz",1),"Shift-ArrowUp":ft("vert",-1),"Shift-ArrowDown":ft("vert",1),Backspace:mt,"Mod-Backspace":mt,Delete:mt,"Mod-Delete":mt});function ml(t,e,n){if(!L(t.state))return!1;let r=ll(n);const i=t.state.selection;if(i instanceof k){r||(r={width:1,height:1,rows:[P.from(_t($(t.state.schema).cell,n))]});const l=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),s=y.get(l).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return r=al(r,s.right-s.left,s.bottom-s.top),ve(t.state,t.dispatch,o,s,r),!0}else if(r){const l=yt(t.state),o=l.start(-1);return ve(t.state,t.dispatch,o,y.get(l.node(-1)).findCell(l.pos-o),r),!0}else return!1}function gl({allowTableNodeSelection:t=!1}={}){return new it({key:W,state:{init(){return null},apply(e,n){const r=e.getMeta(W);if(r!=null)return r==-1?null:r;if(n==null||!e.docChanged)return n;const{deleted:i,pos:l}=e.mapping.mapResult(n);return i?null:l}},props:{decorations:mi,handleDOMEvents:{mousedown:pl},createSelectionBetween(e){return W.getState(e.state)!=null?e.state.selection:null},handleTripleClick:dl,handleKeyDown:fl,handlePaste:ml},appendTransaction(e,n,r){return bi(r,ul(r,n),t)}})}const wt={NextCell:"NextCell",PrevCell:"PrevCell",ExitTable:"ExitTable"},Se=z("PrevCell"),Me=z("NextCell"),De=z("BreakTable"),wl=z("InsertTable"),bl=Fn(t=>({schema:()=>({node:{table:{...pt.table,parseMarkdown:{match:e=>e.type==="table",runner:(e,n,r)=>{const i=n.align,l=n.children.map((o,s)=>({...o,align:i,isHeader:s===0}));e.openNode(r),e.next(l),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="table",runner:(e,n)=>{var r;const i=(r=n.content.firstChild)==null?void 0:r.content;if(!i)return;const l=[];i.forEach(o=>{l.push(o.attrs.alignment)}),e.openNode("table",void 0,{align:l}),e.next(n.content),e.closeNode()}}},table_row:{...pt.table_row,parseMarkdown:{match:e=>e.type==="tableRow",runner:(e,n,r)=>{const i=n.align,l=n.children.map((o,s)=>({...o,align:i[s],isHeader:n.isHeader}));e.openNode(r),e.next(l),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="table_row",runner:(e,n)=>{e.openNode("tableRow"),e.next(n.content),e.closeNode()}}},table_cell:{...pt.table_cell,parseMarkdown:{match:e=>e.type==="tableCell"&&!e.isHeader,runner:(e,n,r)=>{const i=n.align;e.openNode(r,{alignment:i}).openNode(e.schema.nodes.paragraph).next(n.children).closeNode().closeNode()}},toMarkdown:{match:e=>e.type.name==="table_cell",runner:(e,n)=>{e.openNode("tableCell").next(n.content).closeNode()}}},table_header:{...pt.table_header,parseMarkdown:{match:e=>e.type==="tableCell"&&!!e.isHeader,runner:(e,n,r)=>{const i=n.align;e.openNode(r,{alignment:i}),e.openNode(e.schema.nodes.paragraph),e.next(n.children),e.closeNode(),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="table_header",runner:(e,n)=>{e.openNode("tableCell"),e.next(n.content),e.closeNode()}}}}}),inputRules:(e,n)=>[new Be(/^\|\|\s$/,(r,i,l,o)=>{const s=r.doc.resolve(l);if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.table))return null;const a=ge(n.get($t)),c=r.tr.replaceRangeWith(l,o,a).scrollIntoView();return c.setSelection(j.create(c.doc,l+3))})],commands:(e,n)=>[R(Se,()=>me(-1)),R(Me,()=>me(1)),R(De,()=>Ai(n.get($t).nodes.paragraph)),R(wl,()=>(r,i)=>{const{selection:l,tr:o}=r,{from:s}=l,a=ge(n.get($t)),c=o.replaceSelectionWith(a),u=T.findFrom(c.doc.resolve(s),1,!0);return u&&(i==null||i(c.setSelection(u))),!0})],shortcuts:{[wt.NextCell]:V(Me,"Mod-]"),[wt.PrevCell]:V(Se,"Mod-["),[wt.ExitTable]:V(De,"Mod-Enter")},prosePlugins:(e,n)=>[ji(n,t),Ki(),Xi(),gl()]})),ot={...Wn,...wt,StrikeThrough:"StrikeThrough",TaskList:"TaskList"},$e=z("ToggleStrikeThrough"),Le="strike_through",kl=Nn(t=>({id:Le,schema:()=>({inclusive:!1,parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:e=>e==="line-through"}],toDOM:e=>["del",{class:t.getClassName(e.attrs,"strike-through")}],parseMarkdown:{match:e=>e.type==="delete",runner:(e,n,r)=>{e.openMark(r),e.next(n.children),e.closeMark(r)}},toMarkdown:{match:e=>e.type.name===Le,runner:(e,n)=>{e.withMark(n,"delete")}}}),commands:e=>[R($e,()=>Mn(e))],shortcuts:{[ot.StrikeThrough]:V($e,"Mod-Alt-x")}})),Te=z("SplitTaskListItem"),Re=z("SinkTaskListItem"),Ee=z("LiftTaskListItem"),ze=z("TurnIntoTaskList"),Cl=Ut(t=>{const e="task_list_item";return{id:e,schema:n=>({group:"listItem",content:"paragraph block*",defining:!0,priority:60,attrs:{checked:{default:!1}},parseDOM:[{tag:'li[data-type="task-item"]',getAttrs:r=>{if(!(r instanceof HTMLElement))throw Bt(r);return{checked:r.dataset.checked==="true"}}}],toDOM:r=>{const i=document.createElement("input");return i.type="checkbox",i.checked=r.attrs.checked,i.className=t.getClassName(r.attrs,"task-list-item_checkbox"),i.onchange=l=>{const o=l.target;if(!(o instanceof HTMLInputElement))return;const s=n.get(kt);if(!s.editable){i.checked=!i.checked;return}const{top:a,left:c}=o.getBoundingClientRect(),u=s.posAtCoords({top:a,left:c});if(!u)return;const{tr:h}=s.state;s.dispatch(h.setNodeMarkup(u.inside,void 0,{checked:o.checked}))},["li",{"data-type":"task-item","data-checked":r.attrs.checked?"true":"false",class:t.getClassName(r.attrs,"task-list-item")},i,["span",{class:t.getClassName(r.attrs,"task-list-item_body")},0]]},parseMarkdown:{match:({type:r,checked:i})=>r==="listItem"&&i!==null,runner:(r,i,l)=>{r.openNode(l,{checked:i.checked}),r.next(i.children),r.closeNode()}},toMarkdown:{match:r=>r.type.name===e,runner:(r,i)=>{r.openNode("listItem",void 0,{checked:i.attrs.checked}),r.next(i.content),r.closeNode()}}}),inputRules:n=>[He(/^\s*(\[([ |x])\])\s$/,n,r=>({checked:r[r.length-1]==="x"}))],commands:n=>[R(Te,()=>Pn(n)),R(Re,()=>Hn(n)),R(Ee,()=>Bn(n)),R(ze,()=>Dn(n))],shortcuts:{[ot.NextListItem]:V(Te,"Enter"),[ot.SinkListItem]:V(Re,"Mod-]"),[ot.LiftListItem]:V(Ee,"Mod-["),[ot.TaskList]:V(ze,"Mod-Alt-9")},view:()=>(n,r,i)=>{let l=n;const o=t.themeManager.get("task-list-item",{editable:()=>r.editable,onChange:u=>{const{tr:h}=r.state;r.dispatch(h.setNodeMarkup(i(),void 0,{checked:u}))}});if(!o)return{};const{dom:s,contentDOM:a,onUpdate:c}=o;return c(l),{dom:s,contentDOM:a,update:u=>u.type.name!==e?!1:(l=u,c(l),!0)}}}}),yl=In.create([...On,_n(()=>ii),bl(),kl(),Cl(),si(),oi()]),Al=()=>En.make().config(t=>{t.set(zn,document.getElementById("app"))}).use(jn).use(yl).create();export{Al as setup};
